
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Avaliação com Comparativo</title>
</head>
<body>
  <h1>Resultado da Avaliação</h1>
  <canvas id="radar-chart" width="400" height="400"></canvas>
  <div id="results-container"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
function desenharRadarChart(labels, userData, roleAvgData, role) {
  new Chart(document.getElementById("radar-chart"), {
    type: 'radar',
    data: {
      labels,
      datasets: [
        {
          label: 'Seu Resultado',
          data: userData,
          fill: true,
          backgroundColor: 'rgba(233,30,99,0.2)',
          borderColor: '#e91e63',
          pointBackgroundColor: '#e91e63'
        },
        {
          label: `Média da Função (${role})`,
          data: roleAvgData,
          fill: false,
          borderColor: 'rgba(0,123,255,0.7)',
          borderDash: [5, 5],
          pointBackgroundColor: 'rgba(0,123,255,1)'
        }
      ]
    },
    options: {
      scales: {
        r: {
          min: 0,
          max: 5,
          ticks: { stepSize: 1 },
          beginAtZero: true
        }
      }
    }
  });
}

function compararComMediaFuncao(labels, userData, roleAvgData, role) {
  const acima = [], abaixo = [];
  labels.forEach((hab, i) => {
    const u = userData[i];
    const m = roleAvgData[i];
    if (u > m) acima.push(hab);
    else if (u < m) abaixo.push(hab);
  });

  let html = `<h3>Comparativo com Média da Função (${role})</h3>`;
  if (acima.length) html += `<p><strong>Acima da média:</strong> ${acima.join(', ')}</p>`;
  if (abaixo.length) html += `<p><strong>Abaixo da média:</strong> ${abaixo.join(', ')}</p>`;
  if (!acima.length && !abaixo.length) html += `<p>Você está exatamente na média em todas as habilidades.</p>`;

  document.getElementById("results-container").insertAdjacentHTML("beforeend", html);
}

// Exemplo de chamada combinada após gerar resultado (substitua no seu fluxo real)
function exibirComparativoRadar(result, roleAvg, role) {
  const labels = Object.keys(result);
  const userData = Object.values(result).map(v => parseFloat(v));
  const roleData = labels.map(l => parseFloat(roleAvg[l] || 0));
  desenharRadarChart(labels, userData, roleData, role);
  compararComMediaFuncao(labels, userData, roleData, role);
}
</script>

<script>
const result = {
  "Estratégia e Negócio": "4.0",
  "Visão do Produto": "3.2",
  "Discovery": "4.4",
  "Delivery": "4.1",
  "Go to Market": "3.7",
  "Medir e Avaliar": "3.9",
  "Decidir": "3.5",
  "Growth": "2.8",
  "Liderança e Comportamento": "3.6"
};
const mediaFuncao = {
  "Estratégia e Negócio": 3.6,
  "Visão do Produto": 3.5,
  "Discovery": 3.9,
  "Delivery": 3.8,
  "Go to Market": 3.7,
  "Medir e Avaliar": 3.6,
  "Decidir": 3.5,
  "Growth": 3.3,
  "Liderança e Comportamento": 3.4
};
const userRole = "PM Pleno";
exibirComparativoRadar(result, mediaFuncao, userRole);
</script>
</body>
</html>
