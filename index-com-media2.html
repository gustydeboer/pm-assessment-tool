<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="favicon.png" type="image/png" />
  <title>Avaliação de Maturidade de Produto</title>
  
  ;
        }

        const entry = roleStats[role];
        const notas = Object.entries(result);

        notas.forEach(([habilidade, nota]) => {
          if (!entry.habilidades[habilidade]) {
            entry.habilidades[habilidade] = { soma: 0, count: 0 };
          }
          entry.habilidades[habilidade].soma += parseFloat(nota);
          entry.habilidades[habilidade].count += 1;
        });

        const mediaGeral = notas.reduce((sum, [, val]) => sum + parseFloat(val), 0) / notas.length;
        entry.total += mediaGeral;
        entry.count += 1;
      });

      exibirTabelaMedias(roleStats);
    });
  }

  function exibirTabelaMedias(roleStats) {
    let html = `<h2>Média por Função</h2><table><thead><tr><th>Função</th><th>Média Geral</th></tr></thead><tbody>`;
    for (const role in roleStats) {
      const entry = roleStats[role];
      const media = (entry.total / entry.count).toFixed(1);
      html += `<tr><td>${role}</td><td>${media}</td></tr>`;
    }
    html += `</tbody></table>`;
    document.getElementById("results-container").insertAdjacentHTML("beforeend", html);
  }
</script>
  
  

  function saveResults() {
    const result = {};
    sections.forEach(sec => {
      const skillAnswers = answers.filter(a => a.skill === sec.skill);
      const avg = skillAnswers.reduce((sum, a) => sum + a.score, 0) / skillAnswers.length;
      result[sec.skill] = avg.toFixed(1);
    });

    db.collection("assessments").add({
      user: userInfo,
      result,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    }).then(() => {
      showResults(result);
    });
  }

  function showResults(result) {
  document.getElementById("assessment").style.display = "none";
  document.getElementById("results-container").style.display = "block";
  scrollToTop();

  const labels = Object.keys(result);
  const data = Object.values(result).map(v => parseFloat(v));

  new Chart(document.getElementById("radar-chart"), {
  type: 'radar',
  data: {
    labels,
    datasets: [{
      label: 'Maturidade por Habilidade',
      data,
      fill: true,
      backgroundColor: 'rgba(233,30,99,0.2)',
      borderColor: '#e91e63',
      pointBackgroundColor: '#e91e63',
      pointRadius: 5,  // Ajusta o tamanho dos pontos
      pointHoverRadius: 7  // Tamanho quando passar o mouse
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: true,  // Ajustado para manter proporção
    scales: {
      r: {
        min: 0,
        max: 5,
        beginAtZero: true,
        ticks: { 
          stepSize: 1,
          backdropColor: 'transparent'  // Remove fundo dos labels
        },
        grid: {
          color: 'rgba(0, 0, 0, 0.1)'  // Cor mais suave para linhas de grade
        },
        pointLabels: {
          font: {
            size: 10,
            weight: 'bold'
          },
          color: '#333'
        }
      }
    },
    plugins: {
      legend: {
        display: false  // Opcional: remove legenda se não precisar
      },
      tooltip: {
        backgroundColor: '#e91e63',
        titleColor: 'white',
        bodyColor: 'white'
      }
    },
    animation: {
      duration: 1000,  // Animação mais suave
      easing: 'easeOutQuad'
    }
  }
});

  const table = `
    <h2>Notas por Habilidade</h2>
    <table>
      <thead><tr><th>Habilidade</th><th>Média</th></tr></thead>
      <tbody>
        ${labels.map((label, i) => `<tr><td>${label}</td><td>${data[i]}</td></tr>`).join('')}
      </tbody>
    </table>
  `;
  document.getElementById("results-table").innerHTML = table;
}
function scrollToTop() {
  window.scrollTo({ top: 0, behavior: 'smooth' });
}





<script>
  function carregarMediaPorFuncao() {
    const roleStats = {};

    db.collection("assessments").get().then(snapshot => {
      snapshot.forEach(doc => {
        const data = doc.data();
        const role = data.user?.role || "Sem função";
        const result = data.result || {};

        if (!roleStats[role]) {
          roleStats[role] = { total: 0, count: 0, habilidades: {} };
        }

        const entry = roleStats[role];
        const notas = Object.entries(result);

        notas.forEach(([habilidade, nota]) => {
          if (!entry.habilidades[habilidade]) {
            entry.habilidades[habilidade] = { soma: 0, count: 0 };
          }
          entry.habilidades[habilidade].soma += parseFloat(nota);
          entry.habilidades[habilidade].count += 1;
        });

        const mediaGeral = notas.reduce((sum, [, val]) => sum + parseFloat(val), 0) / notas.length;
        entry.total += mediaGeral;
        entry.count += 1;
      });

      exibirTabelaMedias(roleStats);
    });
  }

  function exibirTabelaMedias(roleStats) {
    let html = `<h2>Média por Função</h2><table><thead><tr><th>Função</th><th>Média Geral</th></tr></thead><tbody>`;
    for (const role in roleStats) {
      const entry = roleStats[role];
      const media = (entry.total / entry.count).toFixed(1);
      html += `<tr><td>${role}</td><td>${media}</td></tr>`;
    }
    html += `</tbody></table>`;
    document.getElementById("results-container").insertAdjacentHTML("beforeend", html);
  }
</script>

</body>

<footer>
        <p>&copy; 2025 - todos os direitos reservados para The Pink Guide of Product</p>
    </footer>

</html>